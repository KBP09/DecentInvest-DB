generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String           @id @default(uuid()) @db.Uuid
  email           String           @unique
  password        String
  role            Role?
  createdAt       DateTime         @default(now())
  startups        Startup[]        @relation("StartupOwner") // Relation to startups for startup owners
  ceoProfile      CEOProfile? // Relation to CEO profile
  investorProfile InvestorProfile? // Relation to Investor profile
  otp             Int              @default(0)
  isFirstLogin    Boolean          @default(true)
}

model Startup {
  id          String       @id @default(uuid()) @db.Uuid
  name        String
  ceoName     String
  description String
  fundingGoal Float
  websiteLink String
  createdAt   DateTime     @default(now())
  ownerId     String       @db.Uuid
  owner       User         @relation("StartupOwner", fields: [ownerId], references: [id])
  investments Investment[]
}

model CEOProfile {
  id               String @id @default(uuid()) @db.Uuid
  totalInvestments Float  @default(0) // Total investments received
  startupsCreated  Int    @default(0) // Total startups created
  userId           String @unique @db.Uuid
  user             User   @relation(fields: [userId], references: [id])
}

model InvestorProfile {
  id                  String       @id @default(uuid()) @db.Uuid
  totalAmountInvested Float        @default(0) // Total amount invested by the user
  startupsInvestedIn  Investment[] // Relation to investments
  userId              String       @unique @db.Uuid
  user                User         @relation(fields: [userId], references: [id])
}

model Investment {
  id         String          @id @default(uuid()) @db.Uuid
  amount     Float
  startupId  String          @db.Uuid
  investorId String          @db.Uuid
  startup    Startup         @relation(fields: [startupId], references: [id])
  investor   InvestorProfile @relation(fields: [investorId], references: [id])
}

enum Role {
  INVESTOR
  STARTUP_OWNER
}

model Wallet {
  id           String    @id @default(uuid()) @db.Uuid
  email        String    @unique
  hashMnemonic String    @unique
  password     String
  account      Account[]
  createdAt    DateTime  @default(now())
}

model Account {
  id         String   @id @default(uuid()) @db.Uuid
  walletId   String   @db.Uuid
  address    String   @unique
  privateKey String
  balance    Float    @default(0)
  Wallet     Wallet   @relation(fields: [walletId], references: [id], onDelete: Cascade)
  currency   String
  createdAt  DateTime @default(now())
}
